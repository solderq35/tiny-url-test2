<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>CodePen - TinyURL JS API</title>
  <link rel="stylesheet" href="./style.css">

</head>
<body>
<!-- partial:index.partial.html -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" type="text/javascript"></script>
<div class="contentcontainer">
  <h1>TinyURL API (JavaScript)</h1>
  <br>
  <form name="target" id="target" class="create-form">
    <b>Enter a long URL to make tiny:</b><br>
    <input type="text" id="url" title="#url">
    <input id="submit" title="#submit" type="button" value="Make TinyURL!">
    <small>May contain letters, numbers, and dashes.</small>
    <input type="text" id="ourl" title="#ourl">
    <small>Tiny URL</small><img parent="#ourl" class="copy" />
    <input type="text" id="purl" title="#purl">
    <small>Preview URL</small><img parent="#purl" class="copy" />
  </form>
  <h2>How Above Works (jQuery + ES6):</h2>
  <h3>Hover each element to see it's ID</h3>
  <textarea code rows="72" cols="16" disabled>
var url = $("#url"),
&nbsp;&nbsp;&nbsp;&nbsp;ourl = $("#ourl"),
&nbsp;&nbsp;&nbsp;&nbsp;purl = $("#purl"),
&nbsp;&nbsp;&nbsp;&nbsp;submit = $("#submit");

submit.click(() => {
&nbsp;&nbsp;tinyurl(url.val(), () => {
&nbsp;&nbsp;&nbsp;&nbsp;ourl.val(tinyurl.url);
&nbsp;&nbsp;&nbsp;&nbsp;purl.val(tinyurl.preview);
&nbsp;&nbsp;});
});

/** TinyURL Syntaxes
  * Object options, Function callback
  * Object options
  * String url, Object options
  * String url, Function callback
  * String url
  * URL url
  * URL url, Object options
  */</textarea>
</div>
<script>
  var url = $("#url"), ourl = $("#ourl"), purl = $("#purl"), submit = $("#submit");
  submit.click(() => {
    tinyurl(url.val(), () => {
      ourl.val(tinyurl.url);
      purl.val(tinyurl.preview);
    });
  });

  $("img.copy").click((img) => {
    var text = $(img.target.getAttribute("parent")).select()[0].innerText;
	text = $(img.target.getAttribute("parent")).setSelectionRange(0, 99999)[0].innerText;
	   var oldContentEditable = text.contentEditable,
        oldReadOnly = text.readOnly,
        range = document.createRange();

    text.contentEditable = true;
    text.readOnly = false;
    range.selectNodeContents(text);

    var s = window.getSelection();
    s.removeAllRanges();
    s.addRange(range);

    text.setSelectionRange(0, 999999); // A big number, to cover anything that could be inside the element.

    text.contentEditable = oldContentEditable;
    text.readOnly = oldReadOnly;

    //document.execCommand('copy');
    try {
      alert("The text was " + (document.execCommand("copy", false, text)? "": "not ") + "copied to the clipboard.");
    } catch(e) {
      alert("The text cannot be copied to the clipboard.");
    }
  });
</script>
<!-- partial -->
  <script  src="./script.js"></script>

</body>
</html>
